可以列出所有已注册的主设备号以及对应的设备号名称

```shell
cat /proc/devicesshell
```

显示加载到linux内核中的所有模块

```shell
lsmod
```

dev目录中包含了系统中所有设备文件，这些文件是内核对硬件设备的抽象表示。每个设备文件都代表系统中的一个设备（如硬盘、终端、串口、鼠标等），并且可以通过标准的文件操作（如读写操作）与设备进行交互。

```shell
ls /dev
```

查看设备树中各个节点和属性的文件结构

```shell
ls /proc/device-tree/
```

查看使用platform虚拟总线后的驱动是否存在

```shell
ls /sys/bus/platform/drivers
会得到
imx6ul-led
他是在自己写的驱动文件中在platform_driver中定义的name
```

查看使用platform虚拟总线后的设备是否存在

```shell
ls /sys/bus/platform/devices/
会得到
gpioled
他是设备树中在根节点定义的设备名字
```

查找lcd相关的日志

```shell
dmesg | grep -i lcd
```



### 移植linux的步骤

1. 移植uboot到开发板
2. 移植linux内核（zImage和.dtb）,可以通过tftp在线调试
3. 移植rootfs（根文件系统，本次使用的是buildroot），可以通过nfs在线调试



zImage：压缩映像文件

dts：设备树源码

dtb：将dts编译之后得到的二进制文件



### 移植uboot无法识别网口的原因

1. bootargs后边不加eth0

2. 网口复位脚的clk时钟驱动能力增大，增大电气属性

3. mdio放在&fec1中

4. 状态是disabled不是disable

5. 网口使用的是第一个

   

### 如何自动创建设备节点

1. 创建类class
2. 创建设备device（注意device和devid的区别）



```
node-name@unit-address
```

“node-name”是节点名字，为 ASCII 字符串，节点名字应该能够清晰的描述出节点的功能，比如“uart1”就表示这个节点是 UART1 外设。“unit-address”一般表示设备的地址或寄存器首地址，如果某个节点没有地址或者寄存器的话“unit-address”可以不要，比如“cpu@0”、“interrupt-controller@00a01000”。



```
label: node-name@unit-address
```

引入 label 的目的就是为了方便访问节点，可以直接通过&label 来访问这个节点，比如cpu0:cpu@0，通过&cpu0 就可以访问“cpu@0”这个节点，而不需要输入完整的节点名字。





platform虚拟总线

1. platform驱动driver
2. platform设备device



### uboot配置网络地址

```
setenv ipaddr 192.168.6.50 
setenv gatewayip 192.168.6.1 
setenv netmask 255.255.255.0 
setenv serverip 192.168.6.120 
saveenv
```





### 配置tftp

```
server tftp
{
socket_type = dgram
protocol = udp
wait = yes
user = root
server = / usr / sbin / in.tftpd server_args = -s / home / zuozhongkai / linux / tftpboot /
disable = no
per_source = 11 cps = 100 2 flags = IPv4
}
```



### 重启tftp

```
sudo service tftpd-hpa restart
```



### 在线使用tftp来调试

```
setenv bootargs 'console=tty1 console=ttymxc0,115200 root=/dev/nfs nfsroot=192.168.6.120:/home/bluebox/my_linux/nfs/buildrootfs rw ip=192.168.6.50:192.168.6.120:192.168.6.1:255.255.255.0'

// 192.168.6.120为ubuntu主机的ip
// /home/bluebox/my_linux/nfs/buildrootfs为ubuntu主机中存放tftp的文件
// ip=自己linux主机ip：ubuntu主机ip：网关：掩码（linux主机ip要和ubuntu主机ip要在同一个网段）
```

